<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>RemoteHooking.Inject Method (Int32, InjectionOptions, String, String, Object[])</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:EasyHook.RemoteHooking.Inject(System.Int32,EasyHook.InjectionOptions,System.String,System.String,System.Object[])" /><meta name="Description" content="Injects the given user library into the target process. No memory leaks are left in the target, even if injection fails for unknown reasons." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="EasyHook" /><meta name="file" content="M_EasyHook_RemoteHooking_Inject" /><meta name="guid" content="M_EasyHook_RemoteHooking_Inject" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">EasyHook 2.7 Beta<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_EasyHook.htm" title="EasyHook 2.7 Beta" tocid="roottoc">EasyHook 2.7 Beta</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_EasyHook.htm" title="EasyHook" tocid="N_EasyHook">EasyHook</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_EasyHook_RemoteHooking.htm" title="RemoteHooking Class" tocid="T_EasyHook_RemoteHooking">RemoteHooking Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_EasyHook_RemoteHooking.htm" title="RemoteHooking Methods" tocid="Methods_T_EasyHook_RemoteHooking">RemoteHooking Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_EasyHook_RemoteHooking_Inject.htm" title="Inject Method " tocid="Overload_EasyHook_RemoteHooking_Inject">Inject Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_RemoteHooking_Inject_1.htm" title="Inject Method (Int32, String, String, Object[])" tocid="M_EasyHook_RemoteHooking_Inject_1">Inject Method (Int32, String, String, Object[])</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_RemoteHooking_Inject.htm" title="Inject Method (Int32, InjectionOptions, String, String, Object[])" tocid="M_EasyHook_RemoteHooking_Inject">Inject Method (Int32, InjectionOptions, String, String, Object[])</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">RemoteHooking<span id="LSTE3F55464_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_0?cpp=::|nu=.");</script>Inject Method (Int32, InjectionOptions, String, String, <span id="LSTE3F55464_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_1?cpp=array&lt;");</script>Object<span id="LSTE3F55464_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_2?cpp=&gt;|vb=()|nu=[]");</script>)</td></tr></table><span class="introStyle"></span><script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- EasyHookLeaderBoard728x90 --><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-7073730100723702" data-ad-slot="9421789924"></ins><script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script><div class="summary">
            Injects the given user library into the target process. No memory leaks are left
            in the target, even if injection fails for unknown reasons. 
            </div><p> </p><strong>Namespace:</strong> <a href="N_EasyHook.htm">EasyHook</a><br /><strong>Assembly:</strong> EasyHook (in EasyHook.dll) Version: 2.7.5558.0 (2.7.5558.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cs','1','4');return false;">C#</a></div><div id="ID0EDCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','vb','2','4');return false;">VB</a></div><div id="ID0EDCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cpp','3','4');return false;">C++</a></div><div id="ID0EDCA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDCA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EDCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Inject</span>(
	<span class="identifier">int</span> <span class="parameter">InTargetPID</span>,
	<span class="identifier">InjectionOptions</span> <span class="parameter">InOptions</span>,
	<span class="identifier">string</span> <span class="parameter">InLibraryPath_x86</span>,
	<span class="identifier">string</span> <span class="parameter">InLibraryPath_x64</span>,
	<span class="keyword">params</span> <span class="identifier">Object</span>[] <span class="parameter">InPassThruArgs</span>
)</pre></div><div id="ID0EDCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Sub</span> <span class="identifier">Inject</span> ( 
	<span class="parameter">InTargetPID</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">InOptions</span> <span class="keyword">As</span> <span class="identifier">InjectionOptions</span>,
	<span class="parameter">InLibraryPath_x86</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">InLibraryPath_x64</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="keyword">ParamArray</span> <span class="parameter">InPassThruArgs</span> <span class="keyword">As</span> <span class="identifier">Object</span>()
)</pre></div><div id="ID0EDCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Inject</span>(
	<span class="identifier">int</span> <span class="parameter">InTargetPID</span>, 
	<span class="identifier">InjectionOptions</span> <span class="parameter">InOptions</span>, 
	<span class="identifier">String</span>^ <span class="parameter">InLibraryPath_x86</span>, 
	<span class="identifier">String</span>^ <span class="parameter">InLibraryPath_x64</span>, 
	... <span class="keyword">array</span>&lt;<span class="identifier">Object</span>^&gt;^ <span class="parameter">InPassThruArgs</span>
)</pre></div><div id="ID0EDCA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">Inject</span> : 
        <span class="parameter">InTargetPID</span> : <span class="identifier">int</span> * 
        <span class="parameter">InOptions</span> : <span class="identifier">InjectionOptions</span> * 
        <span class="parameter">InLibraryPath_x86</span> : <span class="identifier">string</span> * 
        <span class="parameter">InLibraryPath_x64</span> : <span class="identifier">string</span> * 
        <span class="parameter">InPassThruArgs</span> : <span class="identifier">Object</span>[] <span class="keyword">-&gt;</span> <span class="keyword">unit</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">InTargetPID</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTE3F55464_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />
            The target process ID.
            </dd><dt><span class="parameter">InOptions</span></dt><dd>Type: <a href="T_EasyHook_InjectionOptions.htm">EasyHook<span id="LSTE3F55464_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InjectionOptions</a><br />
            A valid combination of options.
            </dd><dt><span class="parameter">InLibraryPath_x86</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTE3F55464_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A partially qualified assembly name or a relative/absolute file path of the 32-bit version of your library. 
            For example "MyAssembly, PublicKeyToken=248973975895496" or ".\Assemblies\\MyAssembly.dll". 
            </dd><dt><span class="parameter">InLibraryPath_x64</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTE3F55464_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A partially qualified assembly name or a relative/absolute file path of the 64-bit version of your library. 
            For example "MyAssembly, PublicKeyToken=248973975895496" or ".\Assemblies\\MyAssembly.dll". 
            </dd><dt><span class="parameter">InPassThruArgs</span></dt><dd>Type: <span id="LSTE3F55464_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_7?cpp=array&lt;");</script><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LSTE3F55464_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><span id="LSTE3F55464_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_9?cpp=&gt;|vb=()|nu=[]");</script><br />
            A serializable list of parameters being passed to your library entry points <span class="code">Run()</span> and
            <span class="code">Initialize()</span>.
            </dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/2asft85a" target="_blank">InvalidOperationException</a></td><td>
            It is unstable to inject libraries into the same process. This exception is disabled in DEBUG mode.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/45bkekh3" target="_blank">AccessViolationException</a></td><td>
            Access to target process denied or the current user is not an administrator.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>
            The given process does not exist or unable to serialize/deserialize one or more pass thru arguments.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/dzyy5k3x" target="_blank">FileNotFoundException</a></td><td>
            The given user library could not be found.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/5afc3sdf" target="_blank">OutOfMemoryException</a></td><td>
            Unable to allocate unmanaged memory in current or target process.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/8a7a4e64" target="_blank">NotSupportedException</a></td><td>
            It is not supported to inject into the target process. This is common on Windows Vista and Server 2008.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/cke1faa2" target="_blank">TimeoutException</a></td><td>
            Unable to wait for user library to be initialized. Check your library <span class="code">Initialize()</span> handler.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/kabeyczd" target="_blank">EntryPointNotFoundException</a></td><td>
            The given user library does not export a class implementing the <a href="T_EasyHook_IEntryPoint.htm">IEntryPoint</a> interface.
            </td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
            There are two possible user library paths. The first one should map to
            a 32-bit library, and the second one should map to 64-bit library. If your
            code has been compiled for "AnyCPU", like it's the default for C#, you may
            even specify one library path for both parameters. Please note that your
            library including all of it's dependencies must be registered in the
            Global Assembly Cache (GAC). Refer to <a href="M_EasyHook_Config_Register.htm">Register(String, <span id="LSTE3F55464_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_10?cpp=array&lt;");</script>String<span id="LSTE3F55464_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_11?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>)</a> for more
            information about how to get them there.
            </p><p>
            If you inject a library into any target process please keep in mind that
            your working directory will be switched. EasyHook will automatically add
            the directory of the injecting application as first directory of the target's PATH environment
            variable. So make sure that all required dependencies are either located
            within the injecting application's directory, a system directory or any directory defaultly
            contained in the PATH variable. As all managed assemblies have to be in the GAC
            there is no need for them being in any of those directories!
            </p><p>
            EasyHook provides extensive error information during injection. Any kind of failure is
            being catched and thrown as an exception by this method. If for example your library
            does not expose a class implementing <a href="T_EasyHook_IEntryPoint.htm">IEntryPoint</a>, an exception will be
            raised in the target process during injection. The exception will be redirected to this method
            and you can catch it in a try-catch statement around <span class="selflink">Inject(Int32, InjectionOptions, String, String, <span id="LSTE3F55464_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_12?cpp=array&lt;");</script>Object<span id="LSTE3F55464_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F55464_13?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>)</span>.
            </p><p>
            You will often have to pass parameters to your injected library. <a href="http://msdn2.microsoft.com/en-us/library/tz3ew9z6" target="_blank">IpcChannel</a> 
            names are common, but also any other kind of data can be passed. You may add a custom list
            of objects marked with the <a href="http://msdn2.microsoft.com/en-us/library/bcfsa90a" target="_blank">SerializableAttribute</a>. All common NET classes
            will be serializable by default, but if you are using your own classes you might have to provide
            serialization by yourself. The custom parameter list will be passed unchanged to your injected
            library entry points <span class="code">Run</span> and <span class="code">Initialize</span>. Verify that all required type libraries to deserialize
            your parameter list are in the GAC.
            </p><p>
            It is supported to inject code into 64-bit processes from within 32-bit processes and
            vice versa. It is also supported to inject code into other terminal sessions. Of course
            this will require additional processes and services to be created, but as they are managed
            internally, you won't notice them! There will be some delays when injecting the first library.
            Further injections are completed much faster!
            </p><p>
            Even if it would technically be possible to inject a library for debugging purposes into
            the current process, it will throw an exception. This is because it heavily depends on
            your injected library whether the current process will be damaged. Any kind of communication
            may lead into deadlocks if you hook the wrong APIs. Just use the capability of Visual Studio
            to debug more than one process simultanously which will allow you to debug your library
            as if it would be injected into the current process without running into any side-effects.
            </p><p>
            The given exceptions are those which are thrown by EasyHook code. The NET framework might throw
            any other exception not listed here. Don't rely on the exception type. If you passed valid parameters,
            the only exceptions you should explicitly check for are <a href="http://msdn2.microsoft.com/en-us/library/8a7a4e64" target="_blank">NotSupportedException</a> and
            <a href="http://msdn2.microsoft.com/en-us/library/45bkekh3" target="_blank">AccessViolationException</a>. All others
            shall be catched together and threaded as bad environment or invalid parameter error.
            </p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_EasyHook_RemoteHooking.htm">RemoteHooking Class</a></div><div class="seeAlsoStyle"><a href="Overload_EasyHook_RemoteHooking_Inject.htm">Inject Overload</a></div><div class="seeAlsoStyle"><a href="N_EasyHook.htm">EasyHook Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://easyhook.github.io/" target="_blank">Copyright (C) 2009 Christoph Husse &amp; (C) 2012 Justin Stenning</a></p><script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
  var pageTracker = _gat._getTracker("UA-66127710-1");
  pageTracker._trackPageview();
} catch(err) {}
</script> </div></body></html>