<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Config.Register Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Register method" /><meta name="System.Keywords" content="Config.Register method" /><meta name="Microsoft.Help.F1" content="EasyHook.Config.Register" /><meta name="Microsoft.Help.Id" content="M:EasyHook.Config.Register(System.String,System.String[])" /><meta name="Description" content="REQUIRES ADMIN PRIVILEGES. Installs EasyHook and all given user NET assemblies into the GAC and ensures that all references are cleaned up if the installing application is shutdown. Cleanup does not depend on the calling application..." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="EasyHook" /><meta name="file" content="M_EasyHook_Config_Register" /><meta name="guid" content="M_EasyHook_Config_Register" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">EasyHook 2.7<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_EasyHook.htm" title="EasyHook 2.7" tocid="roottoc">EasyHook 2.7</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_EasyHook.htm" title="EasyHook" tocid="N_EasyHook">EasyHook</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_EasyHook_Config.htm" title="Config Class" tocid="T_EasyHook_Config">Config Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_EasyHook_Config.htm" title="Config Methods" tocid="Methods_T_EasyHook_Config">Config Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_DebugPrint.htm" title="DebugPrint Method " tocid="M_EasyHook_Config_DebugPrint">DebugPrint Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_GetDependantSvcExecutableName.htm" title="GetDependantSvcExecutableName Method " tocid="M_EasyHook_Config_GetDependantSvcExecutableName">GetDependantSvcExecutableName Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_GetProcessPath.htm" title="GetProcessPath Method " tocid="M_EasyHook_Config_GetProcessPath">GetProcessPath Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_GetSvcExecutableName.htm" title="GetSvcExecutableName Method " tocid="M_EasyHook_Config_GetSvcExecutableName">GetSvcExecutableName Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_GetWOW64BypassExecutableName.htm" title="GetWOW64BypassExecutableName Method " tocid="M_EasyHook_Config_GetWOW64BypassExecutableName">GetWOW64BypassExecutableName Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_PrintComment.htm" title="PrintComment Method " tocid="M_EasyHook_Config_PrintComment">PrintComment Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_PrintError.htm" title="PrintError Method " tocid="M_EasyHook_Config_PrintError">PrintError Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_PrintWarning.htm" title="PrintWarning Method " tocid="M_EasyHook_Config_PrintWarning">PrintWarning Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_Register.htm" title="Register Method " tocid="M_EasyHook_Config_Register">Register Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_EasyHook_Config_RunCommand.htm" title="RunCommand Method " tocid="M_EasyHook_Config_RunCommand">RunCommand Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Config<span id="LSTA60D3D42_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_0?cpp=::|nu=.");</script>Register Method </h1></td></tr></table><span class="introStyle"></span>
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- EasyHookLeaderBoard728x90 -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-7073730100723702" data-ad-slot="9421789924"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
 <div class="summary">
            REQUIRES ADMIN PRIVILEGES. Installs EasyHook and all given user NET assemblies into the GAC and
            ensures that all references are cleaned up if the installing application
            is shutdown. Cleanup does not depend on the calling application...
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_EasyHook.htm">EasyHook</a><br />
    <strong>Assembly:</strong>
   EasyHook (in EasyHook.dll) Version: 2.7.6684.0 (2.7.6684.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cs','1','4');return false;">C#</a></div><div id="ID0EDCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','vb','2','4');return false;">VB</a></div><div id="ID0EDCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cpp','3','4');return false;">C++</a></div><div id="ID0EDCA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EDCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Register</span>(
	<span class="identifier">string</span> <span class="parameter">InDescription</span>,
	<span class="keyword">params</span> <span class="identifier">string</span>[] <span class="parameter">InUserAssemblies</span>
)</pre></div><div id="ID0EDCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Sub</span> <span class="identifier">Register</span> ( 
	<span class="parameter">InDescription</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="keyword">ParamArray</span> <span class="parameter">InUserAssemblies</span> <span class="keyword">As</span> <span class="identifier">String</span>()
)</pre></div><div id="ID0EDCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Register</span>(
	<span class="identifier">String</span>^ <span class="parameter">InDescription</span>, 
	... <span class="keyword">array</span>&lt;<span class="identifier">String</span>^&gt;^ <span class="parameter">InUserAssemblies</span>
)</pre></div><div id="ID0EDCA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">Register</span> : 
        <span class="parameter">InDescription</span> : <span class="identifier">string</span> * 
        <span class="parameter">InUserAssemblies</span> : <span class="identifier">string</span>[] <span class="keyword">-&gt;</span> <span class="keyword">unit</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">InDescription</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTA60D3D42_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A description under which the installed files should be referenced. 
            </dd><dt><span class="parameter">InUserAssemblies</span></dt><dd>Type: <span id="LSTA60D3D42_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_2?cpp=array&lt;");</script><a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTA60D3D42_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><span id="LSTA60D3D42_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_4?cpp=&gt;|vb=()|nu=[]");</script><br />
            A list of user assemblies as relative or absolute paths. 
            </dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/dzyy5k3x" target="_blank">FileNotFoundException</a></td><td>
            At least one of the files specified could not be found!
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/92hkyaf2" target="_blank">BadImageFormatException</a></td><td>
            Unable to load at least one of the given files for reflection. 
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>
            At least one of the given files does not have a strong name.
            </td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
            ATTENTION: There are some problems when debugging processes whose libraries
            are added to the GAC. Visual Studio won't start the debug session! There is
            only one chance for you to workaround this issue if you want to install
            libraries AND debug them simultanously. This is simply to debug only one process
            which is the default setting of Visual Studio. Because the libraries are added
            to the GAC AFTER Visual Studio has initialized the debug session, there won't be
            any conflicts; at least so far...
            </p><p>
            In debug versions of EasyHook, you may also check the "Application" event log, which holds additional information
            about the GAC registration, after calling this method. In general this method works
            transactionally. This means if something goes wrong, the GAC state of all related libraries
            won't be violated!
            </p><p>
            The problem with NET assemblies is that the CLR only searches the GAC and
            directories starting with the application base directory for assemblies.
            To get injected assemblies working either all of them have to be located 
            under the target base directory (which is not suitable in most cases) or
            reside in the GAC. 
            </p><p>
            EasyHook provides a way to automatically register all of its own assemblies
            and custom ones temporarily in the GAC. It also ensures
            that all of these assemblies are removed if the installing process exists. 
            So you don't need to care about and may write applications according to
            the XCOPY standard. If your application ships with an installer, you may
            statically install all of your assemblies and the ones of EasyHook into the
            GAC. In this case just don't call <span class="selflink">Register(String, <span id="LSTA60D3D42_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_5?cpp=array&lt;");</script>String<span id="LSTA60D3D42_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA60D3D42_6?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>)</span>. 
            </p><p>
            Of course EasyHook does also take care of multiple processes using the same
            injection libraries. So if two processes are sharing some of those DLLs,
            a stable reference counter ensures that the libraries are kept in the GAC
            if one process is terminated while the other continues running and so continues
            holding a proper GAC reference.
            </p><p>
            Please note that in order to add your library to the GAC, it has to be a valid
            NET assembly and expose a so called "Strong Name". Assemblies without a strong
            name will be rejected by this method!
            </p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_EasyHook_Config.htm">Config Class</a></div><div class="seeAlsoStyle"><a href="N_EasyHook.htm">EasyHook Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter">Documentation built 2018-06-07.<p><a href="https://easyhook.github.io/" target="_blank">Copyright (C) 2009 Christoph Husse &amp; (C) 2012-2017 Justin Stenning</a></p>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
  var pageTracker = _gat._getTracker("UA-66127710-1");
  pageTracker._trackPageview();
} catch(err) {}
</script> </div></body></html>